<div class="modal-overlay">
  <div class="modal">
    <h2>Cadastro de Empréstimos</h2>
    <form (ngSubmit)="salvar()" class="formulario">
      <label>Cliente:</label>
      <select [(ngModel)]="clienteId" name="clienteId" required>
        <option [value]="0" disabled>Selecione</option>
        <option *ngFor="let c of clientes" [value]="c.id">{{ c.nome }}</option>
      </select>

      <label>Data do Empréstimo:</label>
      <input type="date" [(ngModel)]="dataEmprestimo" name="dataEmprestimo" required>

      <label>Moeda:</label>
      <select [(ngModel)]="moeda" name="moeda" (change)="onMoedaChange()" required>
        <option *ngFor="let m of opcoesMoeda" [ngValue]="m.simbolo">
          {{ m.nomeFormatado }} ({{ m.simbolo }})
        </option>
      </select>
      
      <label>Valor Obtido:</label>
      <input type="number" [(ngModel)]="valorObtidoEmprestimo" name="valorObtidoEmprestimo" min="0" step="0.01" required>

      <label>Taxa de Conversão para BRL:</label>
      <input type="number" [(ngModel)]="taxaConversao" name="taxaConversao" min="0" step="0.0001" required>

      <label>Data de Vencimento:</label>
      <input type="date" [(ngModel)]="dataVencimentoEmprestimo" name="dataVencimentoEmprestimo" required>

      <label>Taxa de Juros Mensal (%)</label>
      <input type="number" [(ngModel)]="taxaJurosMensal" name="taxaJurosMensal" min="0" step="0.01" required>

      <button type="submit">{{ editId !== null ? 'Atualizar' : 'Adicionar' }}</button>
      <button type="button" *ngIf="editId !== null" (click)="cancelar()">Cancelar</button>
    </form>

    <table border="1" *ngIf="emprestimos.length > 0" style="margin-top: 10px; width: 100%">
      <thead>
        <tr>
          <th>ID</th>
          <th>Cliente</th>
          <th>Data Empréstimo</th>
          <th>Moeda</th>
          <th>Valor Obtido</th>
          <th>Taxa Conversão</th>
          <th>Data Vencimento</th>
          <th>Meses</th>
          <th>Valor Final (R$)</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let e of emprestimos">
          <td>{{ e.id }}</td>
          <!-- <td>{{ clientes?.find(c => c.id === e.clienteId)?.nome }}</td> -->
          <td>{{ getNomeCliente(e.clienteId) }}</td>
          <td>{{ e.dataEmprestimo | date:'dd/MM/yyyy' }}</td>
          <td>{{ e.moeda }}</td>
          <td>{{ e.valorObtidoEmprestimo | number:'1.2-2' }}</td>
          <td>{{ e.taxaConversao | number:'1.4-4' }}</td>
          <td>{{ e.dataVencimentoEmprestimo | date:'dd/MM/yyyy' }}</td>
          <td>{{ mesesEntre(e) }}</td>
          <td>{{ e.valorTotal | currency:'BRL' }}</td>
          <td>
            <button (click)="editar(e)">Editar</button>
            <button (click)="remover(e.id)">Remover</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

